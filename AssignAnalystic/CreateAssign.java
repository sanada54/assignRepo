Open Default Log as LOG
UserID = _CURRENTUSER
CurrentDate = _TODAY
// 
Role = _PARAM(2)
Output ALPHA Role to Log LOG
CandidateID = _PARAM(3)
Output NUMERIC CandidateID to Log LOG
JobID = _PARAM(4)
Output NUMERIC JobID to Log LOG
ContactID = _PARAM(5)
Output NUMERIC ContactID to Log LOG
ClientID = _PARAM(6)
Output NUMERIC ClientID to Log LOG
InvoicePointID = _PARAM(7)
Output NUMERIC InvoicePointID to Log LOG
// 
StartDate = _PARAM(8)
EndDate = _PARAM(9)
Output DATE StartDate to Log LOG
Output DATE EndDate to Log LOG
// 
StartTime = _PARAM(10)
EndTime = _PARAM(11)
Output TIME StartTime to Log LOG
Output TIME EndTime to Log LOG
// 
AssigType = _PARAM(12)
Output NUMERIC AssigType to Log LOG
// 
Currency = _PARAM(13)
Output NUMERIC Currency to Log LOG
// 
PrimaryJobCategory = _PARAM(14)
Output NUMERIC PrimaryJobCategory to Log LOG
// 
AWRExempt = _PARAM(15)
Output ALPHA AWRExempt to Log LOG
AWRExemptReason = _PARAM(16)
Output NUMERIC AWRExemptReason to Log LOG
// 
WorkForClient = _PARAM(17)
Output ALPHA WorkForClient to Log LOG
QualifiedWeeks = _PARAM(18)
Output NUMERIC QualifiedWeeks to Log LOG
Verified = _PARAM(19)
Output ALPHA Verified to Log LOG
// 
Employee = _PARAM(20)
Output NUMERIC Employee to Log LOG
// 
BreakStart1 = _PARAM(21)
Output TIME BreakStart1 to Log Log
BreakStart2 = _PARAM(23)
Output TIME BreakStart2 to Log Log
BreakStart3 = _PARAM(25)
Output TIME BreakStart3 to Log Log
BreakStart4 = _PARAM(27)
Output TIME BreakStart4 to Log Log
BreakStart5 = _PARAM(29)
Output TIME BreakStart5 to Log Log
BreakEnd1 = _PARAM(22)
Output TIME BreakEnd1 to Log Log
BreakEnd2 = _PARAM(24)
Output TIME BreakEnd2 to Log Log
BreakEnd3 = _PARAM(26)
Output TIME BreakEnd3 to Log Log
BreakEnd4 = _PARAM(28)
Output TIME BreakEnd4 to Log Log
BreakEnd5 = _PARAM(30)
Output TIME BreakEnd5 to Log Log
// 
Get Entity JobID as JobPO
// 
IF (StartTime == _EMPTY)
??????????StartTime = JobPO.attribute("JOB_GEN.START_TM:REFERENCE")
// 
IF (EndTime == _EMPTY)
??????????EndTime = JobPO.attribute("JOB_GEN.END_TM:REFERENCE")
// 
Execute GetUserOffice UserID
OfficeID = _PARAM(2, "GetUserOffice")
Output NUMERIC OfficeID to Log LOG
UserGroup = _PARAM(3, "GetUserOffice")
Output ALPHA UserGroup to Log LOG

TeamID = _PARAM(4, "GetUserOffice")
Output NUMERIC TeamID to Log LOG
UnitID = _PARAM(5, "GetUserOffice")
Output NUMERIC UnitID to Log LOG

Create New Entity AssignmentPO
Assign Role Role to AssignmentPO
Set default role to Role in AssignmentPO
// 
Assign User Group UserGroup to AssignmentPO
// 
JobTitle = JobPO.attribute("JOB_GEN.JOB_TITLE:REFERENCE")
attribute = "ASSIG_GEN.JOB_TITLE:REFERENCE"
Set value for attribute in AssignmentPO to JobTitle
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
attribute = "ASSIG_GEN.ASSIG_TYPE:REFERENCE"
Set value for attribute in AssignmentPO to AssigType
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
AssigStatus = _codeID("Assignment Status\F")
attribute = "ASSIG_GEN.STATUS:REFERENCE"
Set value for attribute in AssignmentPO to AssigStatus
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
attribute = "ASSIG_GEN.START_DT:REFERENCE"
Set value for attribute in AssignmentPO to StartDate
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
attribute = "ASSIG_GEN.END_DT:REFERENCE"
Set value for attribute in AssignmentPO to EndDate
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
IF (StartTime != _EMPTY)
??????????attribute = "ASSIG_GEN.START_TM:REFERENCE"
??????????Set value for attribute in AssignmentPO to StartTime
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
IF (EndTime != _EMPTY)
??????????attribute = "ASSIG_GEN.END_TM:REFERENCE"
??????????Set value for attribute in AssignmentPO to EndTime
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
// 
// Start ==== Modified by Anton M on 06.10.2014; [RandstadJapanDev] Eventum 39994 =====
Set value for "JOB_BREAKS.ST_BREAK1:REFERENCE" in AssignmentPO to BreakStart1
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.ST_BREAK2:REFERENCE" in AssignmentPO to BreakStart2
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.ST_BREAK3:REFERENCE" in AssignmentPO to BreakStart3
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.ST_BREAK4:REFERENCE" in AssignmentPO to BreakStart4
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.ST_BREAK5:REFERENCE" in AssignmentPO to BreakStart5
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.END_BREAK1:REFERENCE" in AssignmentPO to BreakEnd1
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.END_BREAK2:REFERENCE" in AssignmentPO to BreakEnd2
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.END_BREAK3:REFERENCE" in AssignmentPO to BreakEnd3
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.END_BREAK4:REFERENCE" in AssignmentPO to BreakEnd4
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "JOB_BREAKS.END_BREAK5:REFERENCE" in AssignmentPO to BreakEnd5
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// End ==== Modified by Anton M on 06.10.2014; [RandstadJapanDev] Eventum 39994 =====
// 
attribute = "ASSIG_GEN.FILLED_DT:REFERENCE"
Set value for attribute in AssignmentPO to CurrentDate
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
IF (Currency == 0 || Currency == _EMPTY)
??????????Currency = JobPO.attribute("JOB_GEN.CURRENCY:REFERENCE")
??????????Output NUMERIC Currency to Log LOG
IF (Currency != 0 && Currency != _EMPTY)
??????????attribute = "ASSIG_GEN.CURRENCY:REFERENCE"
??????????Set value for attribute in AssignmentPO to Currency
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
// 
IF (InvoicePointID != 0 && InvoicePointID != _EMPTY)
??????????attribute = "ASSIG_GEN.INVP:REFERENCE"
??????????Set value for attribute in AssignmentPO to InvoicePointID
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
// 
IF (Role == "TMPR_ASSIGN" || Role == "TMPS_ASSIGN")
??????????RateCategory = JobPO.attribute("TJOB_GEN.RATE_CAT:REFERENCE")
??????????Output NUMERIC RateCategory to Log LOG
??????????IF (RateCategory != 0 && RateCategory != _EMPTY)
??????????????attribute = "ASSIG_GEN.RATE_CAT:REFERENCE"
??????????????Set value for attribute in AssignmentPO to RateCategory
??????????????????Invalid Attribute
??????????????????Attribute Not Found
??????????????????Invalid Property
??????????????????Invalid Occurrence
??????????????????Entity Ownership Exception
??????????????????Modify Attribute Exception
??????????// 
// 
// AWR - business entity/department
BusinessEntity = JobPO.attribute("JOB_GEN.BUS_EN_DP_AW:REFERENCE")
Output NUMERIC BusinessEntity to Log LOG
IF (BusinessEntity != 0 && BusinessEntity != _EMPTY)
??????????attribute = "ASSIG_GEN.BUS_EN_DP_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to BusinessEntity
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
IF (PrimaryJobCategory!= 0 && PrimaryJobCategory != _EMPTY)
??????????attribute = "ASSIG_GEN.PRIM_JCAT_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to PrimaryJobCategory
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
IF (AWRExempt != 0 && AWRExempt != _EMPTY)
??????????attribute = "ASSIG_GEN.EXEMPT_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to AWRExempt
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
IF (AWRExemptReason != 0 && AWRExemptReason != _EMPTY)
??????????attribute = "ASSIG_GEN.RSN_EXMPT_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to AWRExemptReason
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
// 
IF (WorkForClient != _EMPTY)
??????????attribute = "ASSIG_GEN.SAME_CLNT_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to WorkForClient
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
IF (QualifiedWeeks != 0 && QualifiedWeeks != _EMPTY)
??????????attribute = "ASSIG_GEN.QLF_WEEKS_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to QualifiedWeeks
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
IF (Verified != _EMPTY)
??????????attribute = "ASSIG_GEN.VERIFIED_AW:REFERENCE"
??????????Set value for attribute in AssignmentPO to Verified
??????????????Invalid Attribute
??????????????Attribute Not Found
??????????????Invalid Property
??????????????Invalid Occurrence
??????????????Entity Ownership Exception
??????????????Modify Attribute Exception
// 
// links to job and candidate
attribute = "X_ASSIG_CAND(1).CANDIDATE:ASSIGNMENT"
Set value for attribute in AssignmentPO to CandidateID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
attribute = "X_ASSIG_CAND(1).JOB:ASSIGNMENT"
Set value for attribute in AssignmentPO to JobID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
Attribute = "X_ASSIG_CLI(1).CANDIDATE:ASSIGNMENT"
Set value for Attribute in AssignmentPO to CandidateID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
Attribute = "X_ASSIG_CLI(1).CLIENT:ASSIGNMENT"
WorkClientID = JobPO.attribute("CONTR_INFO(WORKPLACE).CLIENT_ID:REFERENCE")
Output NUMERIC WorkClientID to Log LOG
Set value for Attribute in AssignmentPO to WorkClientID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
Attribute = "X_ASSIG_DEPT(1).CANDIDATE:ASSIGNMENT"
Set value for Attribute in AssignmentPO to CandidateID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
Attribute = "X_ASSIG_DEPT(1).DEPARTMENT:ASSIGNMENT"
WorkDepartmentID = JobPO.attribute("CONTR_INFO(WORKPLACE).DEPARTMENT:REFERENCE")
Output NUMERIC WorkDepartmentID to Log LOG
Set value for Attribute in AssignmentPO to WorkDepartmentID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
// 
IF (Role == "TMPS_ASSIGN" || Role == "TMPR_ASSIGN")
??????????ActivityCode = _CODEID("Activity Action\TJ2")
??????????attributeCons = "OWN_CONS(Temporary).CONSULTANT:REFERENCE"
??????????attributeTeam = "OWN_CONS(Temporary).TEAM:REFERENCE"
??????????attributeUnit = "OWN_CONS(Temporary).UNIT:REFERENCE"
IF (Role == "CONTR_ASSIGN")
??????????ActivityCode = _CODEID("Activity Action\CJ2")
??????????attributeCons = "OWN_CONS(Contract).CONSULTANT:REFERENCE"
??????????attributeTeam = "OWN_CONS(Contract).TEAM:REFERENCE"
??????????attributeUnit = "OWN_CONS(Contract).UNIT:REFERENCE"
IF (Role == "PERM_ASSIGN")
??????????ActivityCode = _CODEID("Activity Action\PJ2")
??????????attributeCons = "OWN_CONS(Permanent).CONSULTANT:REFERENCE"
??????????attributeTeam = "OWN_CONS(Permanent).TEAM:REFERENCE"
??????????attributeUnit = "OWN_CONS(Permanent).UNIT:REFERENCE"
Output NUMERIC JobOWNCons to Log LOG
Set value for attributeTeam in AssignmentPO to TeamID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for attributeUnit in AssignmentPO to UnitID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Set value for "OWN_OFFICE.OFFICE:REFERENCE" in AssignmentPO to OfficeID
??????????Invalid Attribute
??????????Attribute Not Found
??????????Invalid Property
??????????Invalid Occurrence
??????????Entity Ownership Exception
??????????Modify Attribute Exception
Save Entity AssignmentPO
??????????Entity Not Found
??????????Entity Not Locked
??????????Entity Ownership Exception
// 
AssignmentID = AssignmentPO.getEntityID()
Output NUMERIC AssignmentID to Log LOG
Execute Set_X_PA_CLIENT AssignmentID, ClientID, ContactID
Output NUMERIC ActivityCode to Log LOG

Execute ActivityAnalysisUpdateOnCall ActivityCode,JobID,ClientID,JobID,0,0,Employee

_PARAM(1) = AssignmentID
// 
Close Log LOG
Exit with status:0 and Message No: and Focus Window: 